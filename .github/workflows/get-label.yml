name: Label Retrieval

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  retrieve-issue:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Extract issue number
      id: extract-issue
      run: |
        branch_name=${{ github.event.pull_request.head.ref }}
        issue_number=$(echo "$branch_name" | grep -oP '^\d+')
        echo "::set-output name=issue_number::$issue_number"

    - name: Retrieve Issue
      id: retrieve-issue
      run: |
        issue_number=${{ steps.extract-issue.outputs.issue_number }}
        issue_data=$(curl -s "https://api.github.com/repos/$GITHUB_REPOSITORY/issues/$issue_number")
        echo "::set-output name=issue_data::$issue_data"
