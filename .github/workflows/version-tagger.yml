name: Increment semantic version
on:
  pull_request:
    types:
      - closed  
jobs:
  increment-version:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
    
      - name: Get current version
        run: echo "current_version=$(git describe --tags --abbrev=0)" >> "$GITHUB_ENV"
                  
      - name: Increment version
        run: |
          IFS='.' read -r -a version_parts <<< "$current_version"
          major="${version_parts[0]}"
          minor="${version_parts[1]}"
          patch="${version_parts[2]}"

          labels="${{ github.event.pull_request.labels.*.name }}"
          for label in $labels; do
            if [[ "$label" == "enhancement" ]]; then
              # Increment the minor version and set the patch to 0
              ((minor++))
              patch=0
            elif [[ "$label" == "bug" ]]; then
              patch=$((patch + 1))
            fi
          done
          
          new_version="$major.$minor.$patch"
          echo "$new_version"  
            




